<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>NeonBee Airplane Tracker</title>
                <style>
                        body {
                                    font-family: Arial, sans-serif;
                                                background-color: #f0f0f0;
                                                            text-align: center;
                                                                        padding: 20px;
                                                                                }
                                                                                        h1 {
                                                                                                    color: #333;
                                                                                                            }
                                                                                                                    #map {
                                                                                                                                height: 500px;
                                                                                                                                            width: 100%;
                                                                                                                                                    }
                                                                                                                                                            table {
                                                                                                                                                                        width: 100%;
                                                                                                                                                                                    margin-top: 20px;
                                                                                                                                                                                                border-collapse: collapse;
                                                                                                                                                                                                        }
                                                                                                                                                                                                                th, td {
                                                                                                                                                                                                                            padding: 10px;
                                                                                                                                                                                                                                        border: 1px solid #ddd;
                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                        th {
                                                                                                                                                                                                                                                                    background-color: #f4f4f4;
                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                </style>
                                                                                                                                                                                                                                                                                </head>
                                                                                                                                                                                                                                                                                <body>
                                                                                                                                                                                                                                                                                    <h1>NeonBee Airplane Tracker</h1>
                                                                                                                                                                                                                                                                                        <div id="map"></div>
                                                                                                                                                                                                                                                                                            <table>
                                                                                                                                                                                                                                                                                                    <thead>
                                                                                                                                                                                                                                                                                                                <tr>
                                                                                                                                                                                                                                                                                                                                <th>Callsign</th>
                                                                                                                                                                                                                                                                                                                                                <th>Origin Country</th>
                                                                                                                                                                                                                                                                                                                                                                <th>Velocity (m/s)</th>
                                                                                                                                                                                                                                                                                                                                                                                <th>Altitude (m)</th>
                                                                                                                                                                                                                                                                                                                                                                                            </tr>
                                                                                                                                                                                                                                                                                                                                                                                                    </thead>
                                                                                                                                                                                                                                                                                                                                                                                                            <tbody id="airplane-data">
                                                                                                                                                                                                                                                                                                                                                                                                                        <!-- Airplane data will be inserted here -->
                                                                                                                                                                                                                                                                                                                                                                                                                                </tbody>
                                                                                                                                                                                                                                                                                                                                                                                                                                    </table>

                                                                                                                                                                                                                                                                                                                                                                                                                                        <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.js"></script>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.css" />
                                                                                                                                                                                                                                                                                                                                                                                                                                                <script>
                                                                                                                                                                                                                                                                                                                                                                                                                                                        // Initialize the map
                                                                                                                                                                                                                                                                                                                                                                                                                                                                var map = L.map('map').setView([20, 0], 2);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    attribution: '© OpenStreetMap contributors'
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            }).addTo(map);

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    // Function to fetch and display airplane data
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            async function fetchAirplaneData() {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        const response = await fetch('https://opensky-network.org/api/states/all');
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    const data = await response.json();
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                const airplanes = data.states;

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            // Clear previous data
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        document.getElementById('airplane-data').innerHTML = '';

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    airplanes.forEach(plane => {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    const [icao24, callsign, origin_country, time_position, last_contact, longitude, latitude, baro_altitude, on_ground, velocity, true_track, vertical_rate, sensors, geo_altitude, squawk, spi, position_source] = plane;

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    // Add airplane marker to map
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    if (latitude && longitude) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        L.marker([latitude, longitude]).addTo(map)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                .bindPopup(`<b>${callsign}</b><br>${origin_country}`);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                }

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                // Add airplane data to table
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                const row = `<tr>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <td>${callsign}</td>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <td>${origin_country}</td>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <td>${velocity ? velocity.toFixed(2) : 'N/A'}</td>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <td>${geo_altitude ? geo_altitude.toFixed(2) : 'N/A'}</td>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </tr>`;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                document.getElementById('airplane-data').insertAdjacentHTML('beforeend', row);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            });
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    }

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            // Fetch airplane data every 10 seconds
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    fetchAirplaneData();
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            setInterval(fetchAirplaneData, 10000);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </script>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </body>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </html>